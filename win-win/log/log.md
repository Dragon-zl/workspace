# log类

## 说明

```c++
log类 用于对程序运行时对应的状态机行为进行记录
    日志时分为以下几种情况
    "[debug]:"
    "[info]:"
    "[warn]:"
    "[erro]:"
log类规定
    1、日志文件采用一天一个文件的形式(在文件内容没有超额的情况下)
log写入方式：
	1、同步写入(默认)
    2、异步写入
```

## 同步日志模式

```c++
1、需要进行日志写入时，直接通过
    fputs(log_str.c_str(), m_fp);
函数对log文件描述符进行写入
```

## 异步日志模式

**说明**

```c++
异步日志的实现，需要使用 阻塞队列
```

**阻塞队列**

```c++
阻塞队列 包含 一个 block_queue 类
1、技术实现方式：
    采用循环数组实现的阻塞队列，m_back = (m_back + 1)%m_max_size;
	线程安全，每个操作前都要先加互斥锁，操作完后，再解锁
2、阻塞队列的作用
    阻塞队列用于保存每次日志写入的字符串
```

**异步日志实现方式**

```c++
1、入队
    每当需要写入日志时，将写入的内容(字符串)入队
2、使用线程函数，不断循环判断阻塞队列是否有数据可以出队
    void *async_write_log()
    {
        string single_log;
        //从阻塞队列中取出一个日志string，写入文件
        while (m_log_queue->pop(single_log))
        {
            m_mutex.lock();
            fputs(single_log.c_str(), m_fp);
            m_mutex.unlock();
        }
    }
```

